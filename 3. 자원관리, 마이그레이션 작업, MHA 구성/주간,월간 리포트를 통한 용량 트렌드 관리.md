# 자원관리(Capacity) 및 용량 점검 운영 요약

## 1. 목적

운영 DB의 **디스크 용량 고갈(Disk Full) 리스크를 선제적으로 예방**하고, 데이터/로그/백업의 **증가 추이(성장률)를 정량적으로 관리**하기 위해 주간/월간 단위로 용량을 점검하고, 오래된 산출물을 **정책 기반으로 자동 정리(rolling)** 하는 체계를 운영했습니다. 

---

## 2. 운영 대상 및 환경(예시)

* **DBMS**: SQL Server 2019 (15.0.2000.5), Standard Edition (64-bit)
* **서버**: ProLiant DL380 Gen10 / CPU 48 cores / Memory 약 64GB
* **디렉터리(예시)**

  * Data: `S:\SQL_DATA`
  * Backup: `S:\SQL_Backup`
  
* **스토리지 사용량(예시 스냅샷)**

  * `C:\` 58GB / 446GB (13.05%)
  * `E:\` 269GB / 1788GB (15.07%)
  * `F:\` 856GB / 3071GB (27.88%)
  * `S:\` 2279GB / 8191GB (27.83%) 

---

## 3. 자원관리 범위 정의(DBA 관점)

본 문서에서의 “자원관리”는 성능 튜닝(쿼리/인덱스)과 별개로, 운영 안정성을 위해 아래 항목을 **측정 → 임계치 기반 조치 → 추세 관리**하는 활동을 의미합니다.

* **Capacity(용량)**: 데이터/로그/백업 증가율, 디스크 사용률, 예상 소진 시점
* **Retention(보존/롤링)**: 로그/백업 보존기간 정책, 자동 정리 및 증적(로그)
* **Risk Control(리스크 통제)**: Disk Full 예방, 정리 작업의 오삭제 방지, 실패 시 중단/알림

---

## 4. 운영 방식(주간/월간 리포트)

### 4.1 주간 점검(Weekly)

* **디스크(드라이브) 사용률 점검**: DB 파일 저장 드라이브, 백업 저장 드라이브 중심
* **증가 이상징후 탐지**: 특정 기간 급증(로그 폭증/백업 적체) 여부 확인
* **조치 트리거**: 임계치 초과 시 정리/증설/원인분석(로그 폭증 원인, 배치/작업 확인)

> 산출물 예시: “주간 DB 디스크 용량 점검” 시트(드라이브별 사용률/증감)

### 4.2 월간 점검(Monthly)

* **월간 용량 변화 추세**(전월 대비 증감, 증가율)
* **성능/운영 지표(선택)**: 세션/CPU/디스크 큐 등 주요 카운터를 함께 기록해 “용량-부하” 연관성 점검

> 예시(월간 지표 비교 형태): Active Sessions, CPU, Disk Queue Length, Batch Requests/sec 등을 전월 대비로 비교 정리 

---

## 5. 자동화: 로그/백업 롤링 삭제(PowerShell)

### 5.1 목표

* 오래된 로그/백업 파일 누적으로 인한 **디스크 고갈 리스크 제거**
* 월/주간 점검에서 확인된 보존정책을 **자동 실행**으로 고정화

### 5.2 정책(예시 템플릿)

* **보존기간**:

  * Full Backup: N일
  * Diff/Log: N일
  * Error Log/기타 로그: N일
* **예외**: 감사/장애 분석 용도 파일은 별도 보관
* **실행 주기**: 1일 1회(또는 주 1회), Windows 작업 스케줄러 등록

### 5.3 안전장치(오삭제 방지 체크리스트)

* (필수) 파일명 패턴/경로 화이트리스트 검증 후 삭제
* (권장) **최근 성공 백업 존재 여부 확인** 후 롤링 수행
* (필수) 삭제 전/후 **용량 변화 및 삭제 대상 목록 로그** 기록
* (권장) 실패 시 중단 및 알림(메일/이벤트로그/메신저)

### 5.4 산출물(포트폴리오에 포함 권장)

* PowerShell 스크립트(핵심 로직) + 작업 스케줄러 설정 캡처
* 실행 로그 샘플(삭제 개수/삭제 용량/잔여 용량)
* “보존정책 표(Retention Policy)” 1장

---

## 6. 결과(정리 포인트)

* **운영 안정성**: 로그/백업 적체로 인한 Disk Full 위험을 사전 차단(주간/월간 모니터링 + 자동 롤링)
* **운영 효율화**: 수동 정리 업무를 자동화하여 반복 작업을 제거하고, 점검 리포트로 의사결정(정리/증설/원인 분석)을 표준화
* **증빙 가능성**: 리포트(주간/월간), 스크립트, 실행 로그를 통해 “자원관리 체계”를 문서로 증빙 가능 

---

## 7. 첨부(증빙 자료 구성 예시)

* 주간 용량 점검 리포트(드라이브/DB/로그/백업)
* 월간 운영 리포트(성능 카운터 포함 가능)
* PowerShell 롤링 삭제 스크립트 + 실행 로그 + 스케줄러 설정 캡처

---
