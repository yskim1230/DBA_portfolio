# 데이터베이스 인덱스 최적화 및 IO 부하 개선 사례

## 1. 개요

* **목적**: 빈번하게 호출되는 주요 쿼리의 인덱스 최적화를 통한 서버 리소스(CPU, IO) 확보 및 서비스 응답 속도 개선
* **주요 성과**: 논리적 읽기 수 최대 **99.9% 이상 절감** (약 10만 건 → 10건 미만)


[문제 확인]

![0  GGEnglish2011 TBL_Mem_Login_his DISK IO 과다현상](https://github.com/user-attachments/assets/924151eb-215f-41dc-b37b-ea8a43638ff0)

[I/O 과다확인]

![1  GGEnglish2011 TBL_Mem_Login_his DISK IO 과다현상](https://github.com/user-attachments/assets/5116a6db-3f01-4fa7-bb55-22889e1506e3)


---

## 2. 사례별 개선 상세

### 사례 1. `sh_content` 테이블 조회 최적화

* **현황**: `TsherpaClass` 서비스에서 특정 게시물 조회 시 과도한 IO 발생
* **문제점**: 인덱스 부재로 인해 단 1행을 찾기 위해 테이블 전체를 뒤지는 비효율 발생
* **조치**: 조회 조건인 `post_id`와 `board_type`을 결합한 복합 인덱스 생성

| 항목 | 개선 전 (Before) | 개선 후 (After) | 개선율 |
| --- | --- | --- | --- |
| **논리적 읽기** | **106,149** | **3** | **99.99%** |
| **스캔 수** | 13 | 1 | - |
| **적용 인덱스** | - | `IX_sh_content_post_id_board_type` | - |

---

### 사례 2. `Tbl_Mem_Login_His` 로그인 이력 조회 최적화

* **현황**: `GGEnglish2011` DB에서 로그인 이력 집계 시 초당 논리적 읽기 수가 약 26만 건까지 치솟으며 병목 현상 발생
* **문제점**: 클러스터형 인덱스 스캔(Clustered Index Scan) 방식으로 약 700만 건 이상의 데이터를 매번 전수 조사함
* **조치**: `Site`, `RegDate` 컬럼을 포함한 비클러스터형 인덱스(`IX_Tbl_Mem_Login_His_Site`) 신규 생성

| 항목 | 개선 전 (Before) | 개선 후 (After) | 개선율 |
| --- | --- | --- | --- |
| **논리적 읽기** | **133,653** | **10** | **99.99%** |
| **실행 방식** | Clustered Index Scan | **Index Seek** | - |
| **예상 비용** | 98.3285 | 0.001 | - |

[개선]

![2  GGEnglish2011 TBL_Mem_Login_his 인덱스 신규 생성 후 DISK IO 감소](https://github.com/user-attachments/assets/14f7ca8d-7ef3-432f-ab6b-c5647a082912)

---

## 3. 기술적 분석 및 기대 효과

### ① Index Scan에서 Index Seek로의 전환

* 기존에는 조건에 맞는 데이터를 찾기 위해 수백만 페이지를 뒤져야 했으나, 개선 후 인덱스 트리를 타고 원하는 지점으로 바로 이동(Seek)함으로써 불필요한 데이터 조회를 제거했습니다.

### ② 시스템 자원 효율화

* **CPU 부하 감소**: 논리적 읽기 횟수가 줄어들면서 데이터를 메모리로 로드하고 연산하는 CPU 점유율이 낮아집니다.
* **대기 시간 단축**: IO 병목(CXCONSUMER 등 대기 유형)이 해소되어 서비스 전체의 응답 속도가 향상됩니다.

---

## 4. 향후 관리 계획

* MaxGauge 모니터링을 통해 `Logical Reads/s` 수치가 높은 상위 쿼리를 주기적으로 점검하겠습니다.
* 실행 계획 분석 시 'Index Scan'이 발생하는 쿼리 중 데이터량이 많은 테이블을 우선순위로 선정하여 인덱스 최적화를 지속하겠습니다.
